angular.module("kdarcel.vlc-player",["kdarcel.vlc-player.tpl","ui.bootstrap"]).constant("VERSION","v1.2.0").run(["$rootScope","VERSION",function(l,n){l.version=n}]).filter("range",function(){return function(l,n){n=parseInt(n);for(var e=0;e<n;e++)l.push(e);return l}}).filter("time2String",function(){return function(l){if(!l)return"00:00";var n=parseInt(l/1e3%60),e=parseInt(l/6e4%60),t=parseInt(l/36e5%24),c="";return t&&(c+=(t<10?"0"+t:t)+":"),c+=(e<10?"0"+e:e)+":",c+=n<10?"0"+n:n}}).factory("poollingFactory",["$timeout",function(l){function n(t,c){return l(t,1e3*e).then(function(){n(t,c)})}var e=1;return{callFnOnInterval:n}}]).directive("vlcplayer",["$templateCache","poollingFactory",function(l,n){return{restrict:"E",replace:!0,template:l.get("angular-vlc.tpl.html"),link:function(l,e,t){l.$watch(function(){return l.vlc&&(3==vlc.input.state&&(l.videoDuration=l.vlc.input.length,l.vlc.openning=!1,l.vlc.buffer=!1),7==vlc.input.state&&null===l.vlc.error&&(l.vlc.error=!0),4!=vlc.input.state&&5!=vlc.input.state&&6!=vlc.input.state||(2==vlc.input.state&&(l.vlc.buffer=!0),1==vlc.input.state&&(l.vlc.openning=!0),l.vlc.toolbar=!0)),{url:t.vlcUrl,filename:t.vlcFilename,autoplay:t.vlcAutoplay}},function(n){if(n.url&&n.filename&&(l.vlc=document.getElementById("vlc"),l.vlc)){l.vlc.playlist.items.count>0&&l.vlc.playlist.items.clear();var e=[":vout-filter=deinterlace",":deinterlace-mode=linear"],t=l.vlc.playlist.add(n.url,n.filename,e);"true"==n.autoplay&&l.vlc.playlist.playItem(t),l.vlc.version=l.vlc.versionInfo(),l.vlc.toolbarWidth={width:"640"},l.vlc.toolbarClass="toolbar-vlc",l.vlc.fullscreenClass="vlc-window"}},!0),l.vlcKeyEvent=function(n){32==n.keyCode&&l.vlc.playlist.togglePause()},l.vlcToolbarActive=function(n){l.vlc.toolbar=n},l.vlcTogglePause=function(){l.vlc.playlist.togglePause()},l.vlcToggleMute=function(){l.vlc.audio.toggleMute()},l.vlcSwitchAudioTrack=function(n){l.vlc.audio.track=n},l.vlcSwitchSubtitleTrack=function(n){l.vlc.subtitle.track=n},l.changeTime=function(n){var e=document.getElementById("player-progress"),t=(document.getElementById("progress"),Math.floor(n.offsetX/e.offsetWidth*100));vlc.input.time=l.videoDuration*t/100},$(document).on("webkitfullscreenchange mozfullscreenchange fullscreenchange",function(n){var e=l.vlc.input.position;l.vlc.playlist.stop(),document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement?(l.vlc.embedFullscreen={width:screen.width,height:screen.height},l.vlc.toolbarWidth={width:screen.width},l.vlc.toolbarClass="toolbar-vlc-fullscreen",l.vlc.fullscreenClass="vlc-fullscreen"):(l.vlc.embedFullscreen={width:"640",height:"360"},l.vlc.toolbarWidth={width:"640"},l.vlc.toolbarClass="toolbar-vlc",l.vlc.fullscreenClass="vlc-window"),l.vlc.playlist.play(),l.vlc.input.position=e}),l.vlcToggleFullscreen=function(){if(document.fullscreenElement||document.mozFullScreenElement||document.webkitFullscreenElement)document.cancelFullScreen?document.cancelFullScreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen();else{var l=document.getElementById("player");l.requestFullscreen?l.requestFullscreen():l.msRequestFullscreen?l.msRequestFullscreen():l.mozRequestFullScreen?l.mozRequestFullScreen():l.webkitRequestFullscreen&&l.webkitRequestFullscreen()}},n.callFnOnInterval(function(){l.vlc&&(l.videoCurrentTime=l.vlc.input.time,l.vlc.timer=l.videoCurrentTime/l.videoDuration*100)})}}}]),function(l){try{l=angular.module("kdarcel.vlc-player.tpl")}catch(n){l=angular.module("kdarcel.vlc-player.tpl",[])}l.run(["$templateCache",function(l){l.put("angular-vlc.tpl.html",'<div class="player-container" id="player" ng-keydown="vlcKeyEvent($event);">\n    <div ng-class="{true: \'player-blur-vlc\' }[vlc.buffer == true]" class="{{ vlc.fullscreenClass }}">\n        <object classid="clsid:9BE31822-FDAD-461B-AD51-BE1D1C159921" events="true" width="100%" height="100%" tabindex="0">\n            <embed pluginspage="http://www.videolan.org"\n                   type="application/x-vlc-plugin"\n                   version="VideoLAN.VLCPlugin.2"\n                   allowfullscreen="true"\n                   width="640"\n                   height="360"\n                   toolbar="false"\n                   branding="false"\n                   windowless="true"\n                   id="vlc"\n                   ng-style="vlc.embedFullscreen">\n        </object>\n    </div>\n    <div class="video-controls" ng-mouseover="vlcToolbarActive(true);" ng-mouseleave="vlcToolbarActive(false);">\n        <div class="{{ vlc.toolbarClass }}" ng-class="{true: \'toolbar-active-vlc\', false: \'toolbar-disabled-vlc\'}[vlc.error == true || vlc.toolbar == true]" ng-style="vlc.toolbarWidth">\n            <div class="progress-vlc" id="player-progress" ng-click="changeTime($event)">\n                <div class="progress-bar" id="progress" role="progressbar" aria-valuenow="{{ vlc.timer }}" aria-valuemin="0" aria-valuemax="100" ng-style="{width : ( vlc.timer + \'%\' ) }">\n                </div>\n            </div>\n            <div class="form-inline pull-left">\n                <button type="button" class="btn btn-default btn-default-vlc btn-xs" tooltip="Play/Pause" ng-click="vlcTogglePause()">\n                    <span class="glyphicon" ng-class="vlc.playlist.isPlaying ? \'glyphicon-pause\' : \'glyphicon-play\'"></span>\n                </button>\n                <span class="vlc-text-white">{{ videoCurrentTime | time2String }} <span ng-if="videoDuration">/ {{ videoDuration | time2String }}</span></span>\n            </div>\n            <div class="form-inline pull-right">\n                <button type="button" class="btn btn-default btn-default-vlc btn-xs" tooltip="Mute/Unmute" ng-click="vlcToggleMute()">\n                    <span class="glyphicon" ng-class="vlc.audio.mute ? \'glyphicon-volume-off\' : \'glyphicon-volume-up\'"></span>\n                </button>\n                <div class="btn-group display-hover dropup" ng-disabled="vlc.audio.count == 0" uib-dropdown>\n                    <button type="button" class="btn btn-default btn-default-vlc btn-xs" uib-dropdown-toggle data-toggle="dropdown" ng-disabled="vlc.audio.count == 0">\n                        <span class="glyphicon glyphicon-sound-5-1"></span>\n                    </button>\n                    <ul class="dropdown-menu" role="menu">\n                        <li ng-repeat="n in [] | range:vlc.audio.count">\n                            <a href="" ng-click="vlcSwitchAudioTrack(n)">\n                                {{ vlc.audio.description(n) }}&nbsp;<span class="glyphicon glyphicon-ok" ng-show="vlc.audio.track == n"></span>\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n                <div class="btn-group display-hover dropup" ng-disabled="vlc.subtitle.count == 0" uib-dropdown>\n                    <button type="button" class="btn btn-default  btn-default-vlc btn-xs" uib-dropdown-toggle data-toggle="dropdown" ng-disabled="vlc.subtitle.count == 0">\n                        <span class="glyphicon glyphicon-subtitles"></span>\n                    </button>\n                    <ul class="dropdown-menu" role="menu">\n                        <li ng-repeat="n in [] | range:vlc.subtitle.count">\n                            <a href="" ng-click="vlcSwitchSubtitleTrack(n)">\n                                {{ vlc.subtitle.description(n) }}&nbsp;<span class="glyphicon glyphicon-ok" ng-show="vlc.subtitle.track == n"></span>\n                            </a>\n                        </li>\n                    </ul>\n                </div>\n                <div class="btn-group dropup" uib-dropdown>\n                    <button type="button" class="btn btn-default btn-default-vlc btn-xs" uib-dropdown-toggle tooltip="Parameters">\n                        <span class="glyphicon glyphicon-cog"></span>\n                    </button>\n                    <ul class="dropdown-menu" uib-dropdown-menu>\n                        <li><a href="https://github.com/Tuxity/angular-vlc/tree/{{ version }}" target="blank"> About angular-vlc </a></li>\n                        <li><a href=""> VLC {{ vlc.version }}</a></li>\n                    </ul>\n                </div>\n                <button type="button" class="btn btn-default btn-default-vlc btn-xs" tooltip="Fullscreen" ng-click="vlcToggleFullscreen()">\n                    <span class="glyphicon glyphicon-resize-full"></span>\n                </button>\n            </div>\n        </div>\n    </div>\n    <div class="error-vlc" ng-if="vlc.error">\n        <p>There is an error with the link your given...</p>\n    </div>\n    <div class="error-vlc" ng-if="vlc.buffer">\n        <p>Video is actually buffering, please wait...</p>\n    </div>\n    <div class="error-vlc" ng-if="vlc.openning">\n        <p>Video will be open in few seconds...</p>\n    </div>\n</div>\n')}])}();